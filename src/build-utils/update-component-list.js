const fs = require('fs');
const path = require('path');

const componentList = fs
  .readdirSync(path.resolve(__dirname, '../components'))
  .filter(component => fs.existsSync(path.resolve(__dirname, `../components/${component}/README.md`)));

// Copy the readme files.
componentList.forEach((component) => {
  fs.copyFileSync(
    path.resolve(__dirname, `../components/${component}/README.md`),
    path.resolve(__dirname, `../../docs/components/${component}.md`),
  );
});

const componentsFileContent = `\
/**
 * Generated by: src/build-utils/update-comoonent-list.js
 * Generated on: ${new Date().toDateString()}
 */

module.exports = [
${componentList
    .map(component => `  '/components/${component}',`)
    .join('\n')}
];
`;

fs.writeFileSync(path.resolve(__dirname, '../../docs/.vuepress/component-list.js'), componentsFileContent);
